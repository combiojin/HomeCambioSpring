<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="member">

	<!-- 회원 목록 가져오기 -->
	<select id="memberList"
		resultType="com.cambio.org.member.MemberDTO">
		select
		*
		from
		`cambio`.`member`
		<trim prefix="where" prefixOverrides="AND|OR">
			<if
				test="searchType=='member_id' and keyword != null and keyword != '' ">
				AND member_id like concat('%', #{keyword}, '%')
			</if>
		</trim>
		order by member_idx desc
		LIMIT #{startList}, #{listSize}
	</select>

	<select id="memberListCnt" resultType="int">
		SELECT
		count(*) as listCnt
		FROM
		`cambio`.`member`
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="keyword != null and keyword != '' ">
				<if test="searchType=='member_id'">
					AND member_id like CONCAT('%', #{keyword}, '%')
				</if>
			</if>
		</trim>
	</select>

	<!-- 회원가입 -->
	<insert id="insertMember"
		parameterType="com.cambio.org.member.MemberDTO">
		insert into `cambio`.`member`
		(member_id,member_pw,member_cpw,member_mail)
		values
		(#{member_id},#{member_pw},#{member_cpw},#{member_mail})
	</insert>

	<!-- 회원정보 상세 보기 -->
	<select id="viewMember"
		resultType="com.cambio.org.member.MemberDTO">
		select * from `cambio`.`member` where
		member_id=#{member_id}
	</select>

	<!-- 회원 정보 수정 -->
	<update id="updateMember">
		update `cambio`.`member`
		set
		member_pw=#{member_pw},member_cpw=#{member_cpw},member_mail=#{member_mail}
		where member_id=#{member_id}
	</update>

	<!-- 관리자계정 회원정보 수정 -->
	<update id="adminUpdate"
		parameterType="com.cambio.org.member.MemberDTO">
		update member set member_id=#{member_id},
		member_pw=#{member_pw}, member_cpw=#{member_cpw},
		member_mail=#{member_mail}
		where member_idx=#{member_idx}
	</update>

	<!-- 로그인 -->
	<select id="memberlogin"
		resultType="com.cambio.org.member.MemberDTO">
		select member_id from `cambio`.`member`
		where
		member_id=#{member_id} and member_pw=#{member_pw}
	</select>

	<!-- 순번 select -->
	<select id="memberSelect"
		resultType="com.cambio.org.member.MemberDTO">
		select * from `cambio`.`member` where
		member_idx=#{member_idx}
	</select>

	<!-- 비밀번호 체크 -->
	<select id="checkpw">
		select count(*) from `cambio`.`member`
		where
		member_id=#{member_id} and member_pw=#{member_pw}
	</select>

	<!-- 회원 삭제 -->
	<delete id="deleteMember">
		delete from `cambio`.`member`
		where
		member_id=#{member_id}
	</delete>

	<!-- select delete -->
	<delete id="memberSelectDelete" parameterType="String">
		delete from `cambio`.`member`
		<where>
			FIND_IN_SET(member_idx, #{idxs})
		</where>
	</delete>

</mapper>